import{s as t}from"./darkMode-B-Ivf8oh.js";document.addEventListener("DOMContentLoaded",async()=>{const{data:{session:s}}=await t.auth.getSession();if(s&&s.user){const a=s.user.id,{data:r}=await t.from("admin").select("id").eq("id",a).single();if(r){window.location.href="AdminDashboard.html";return}const{data:e}=await t.from("users").select("id").eq("id",a).single();if(e){window.location.href="UserDashboard.html";return}}const o=document.getElementById("resetForm");o.addEventListener("submit",async a=>{a.preventDefault();const r=document.getElementById("email").value.trim();if(!r){alert("Please enter your email.");return}try{let e=!1;const{data:d}=await t.from("admin").select("id").eq("adminemail",r).maybeSingle();if(d)e=!0;else{const{data:l,error:n}=await t.from("users").select("id").eq("email",r).maybeSingle();l&&(e=!0),n&&n.code!=="PGRST116"&&console.warn("Could not verify/search users table:",n)}if(!e){alert("This email is not registered in our system.");return}const{data:m,error:i}=await t.auth.resetPasswordForEmail(r,{redirectTo:new URL("ChangePassword.html",window.location.href).href});if(i){alert("Error sending reset email: "+i.message),console.error(i);return}alert("Password reset email sent! Please check your inbox."),o.reset()}catch(e){console.error("Unexpected error:",e),alert("Unexpected error: "+e.message)}})});
