import{s as l}from"./darkMode-B-Ivf8oh.js";document.addEventListener("DOMContentLoaded",async()=>{const{data:{session:t}}=await l.auth.getSession();if(!t){window.location.href="Login.html";return}document.getElementById("mainContent").classList.remove("hidden"),m()});async function m(){const{data:{session:t}}=await l.auth.getSession();if(!t||!t.user){window.location.href="Login.html";return}const n=t.user,o=n.id,{data:e,error:a}=await l.from("users").select("*").eq("id",o).single();if(a){console.error("Error loading profile:",a);return}document.getElementById("fullName").textContent=e.first_name+" "+e.last_name,document.getElementById("email").textContent=n.email,document.getElementById("department").textContent=e.department,document.getElementById("role").textContent=e.role,document.getElementById("fullNameInput").value=e.first_name+" "+e.last_name,document.getElementById("emailInput").value=n.email,document.getElementById("departmentInput").value=e.department,document.getElementById("phoneInput").value=e.phone||"",document.getElementById("displayNameInput").value=e.display_name||"",e.profile_image_url&&(document.getElementById("profileImage").src=e.profile_image_url),d(o)}function d(t){document.getElementById("profileForm").addEventListener("submit",async n=>{n.preventDefault();const o=document.getElementById("phoneInput").value.trim(),e=document.getElementById("displayNameInput").value.trim(),{error:a}=await l.from("users").update({phone:o,display_name:e}).eq("id",t);if(a){alert("Failed to update profile: "+a.message);return}alert("Profile updated successfully!")})}
