import{s as d}from"./darkMode-B-Ivf8oh.js";const A=document.getElementById("adminName"),C=document.getElementById("adminRole"),N=document.getElementById("adminEmail"),x=document.getElementById("adminId"),L=document.getElementById("totalHandled"),I=document.getElementById("logoutBtn"),B=document.getElementById("headerLogoutBtn"),b=document.getElementById("defaultProfileIcon"),g=document.getElementById("profileImage");document.addEventListener("DOMContentLoaded",async()=>{const{data:{session:e}}=await d.auth.getSession();if(!e){window.location.href="Login.html";return}document.getElementById("mainContent").classList.remove("hidden"),w(),q()});async function w(){const{data:{session:e}}=await d.auth.getSession();if(!e){window.location.href="Login.html";return}const{data:t,error:n}=await d.from("admin").select("*").eq("id",e.user.id).single();if(n||!t){console.error("Error fetching admin data:",n),alert("Failed to load profile.");return}if(A.textContent=`${t.adminfirstname} ${t.adminlastname}`,C.textContent=t.adminrole,N.textContent=t.adminemail,x.textContent=t.id,t.profile_pic){g.src=t.profile_pic,g.classList.remove("hidden"),b.classList.add("hidden");const s=document.getElementById("profileButton");s&&(s.innerHTML=`
                <img src="${t.profile_pic}" alt="Profile" class="h-10 w-10 rounded-full object-cover">
            `)}else g.classList.add("hidden"),b.classList.remove("hidden");D(t.id,t.adminrole);const o=document.getElementById("navDashboard")||document.getElementById("profileNavDashboard"),a=document.getElementById("navAllComplaints")||document.getElementById("profileNavAllComplaints"),i=document.getElementById("navAnalytics")||document.getElementById("profileNavAnalytics"),l=document.getElementById("mobileNavDashboard")||document.getElementById("mobileProfileNavDashboard"),m=document.getElementById("mobileNavAllComplaints")||document.getElementById("mobileProfileNavAllComplaints"),y=document.getElementById("mobileNavAnalytics")||document.getElementById("mobileProfileNavAnalytics");if(t.adminrole==="LostAndFound Admin"){o&&(o.href="AdminLostFoundDashboard.html"),l&&(l.href="AdminLostFoundDashboard.html"),a&&(a.textContent="Manage Items",a.href="AdminLostFound.html"),m&&(m.innerHTML='<i class="fas fa-box-open w-6 mr-3 text-lg"></i> Manage Items',m.href="AdminLostFound.html"),i&&(i.style.display="none"),y&&(y.style.display="none");const s=document.getElementById("footerNavDashboard"),r=document.getElementById("footerNavAllComplaints"),h=document.getElementById("footerNavAnalytics");if(s&&(s.href="AdminLostFoundDashboard.html"),r){const v=r.querySelector("span"),p=r.querySelector("i");v&&(v.textContent="Manage Items"),p&&(p.className="fas fa-search"),r.href="AdminLostFound.html"}h&&(h.style.display="none");const u=document.querySelector("footer h2"),E=document.querySelector("footer p");u&&(u.textContent="ComplaNet Lost & Found",u.className="text-2xl font-heading font-bold mb-3 text-[var(--color-blue-btn)] dark:text-blue-400"),E&&(E.textContent="Administrative portal for managing university lost and found items. Monitor, verify, and resolve reports efficiently.");const f=document.querySelector(".bg-gray-50.dark\\:bg-gray-700\\/50 p");f&&f.textContent==="Complaints Handled"&&(f.textContent="Items Handled")}}async function D(e,t){try{let n=0;if(t==="LostAndFound Admin"){const{count:o,error:a}=await d.from("lost_and_found").select("item_id",{count:"exact",head:!0}).eq("admin_id",e);if(a)throw a;const{count:i,error:l}=await d.from("found_items").select("found_item_id",{count:"exact",head:!0}).eq("admin_id",e);if(l)throw l;n=(o||0)+(i||0)}else{let o=d.from("complaint").select("complaintid",{count:"exact",head:!0});t!=="Master Admin"&&(o=o.eq("adminid",e));const{count:a,error:i}=await o;if(i)throw i;n=a||0}L.textContent=n}catch(n){console.error("Error loading stats:",n),L.textContent="-"}}function q(){I&&I.addEventListener("click",c),B&&B.addEventListener("click",c);const e=document.getElementById("logoutModal");if(e){const n=document.getElementById("cancelLogoutBtn"),o=document.getElementById("confirmLogoutBtn");n&&n.addEventListener("click",()=>{e.classList.add("hidden")}),o&&o.addEventListener("click",async()=>{const{error:a}=await d.auth.signOut();a&&console.error("Error signing out:",a),window.location.href="Login.html"}),e.addEventListener("click",a=>{a.target===e&&e.classList.add("hidden")})}const t=setInterval(()=>{const n=document.querySelector('#mobileMenu a[href="Login.html"]');if(n)n.addEventListener("click",c),clearInterval(t);else if(document.readyState==="complete"){const o=document.querySelector('#mobileMenu a[href="Login.html"]');o&&o.addEventListener("click",c),clearInterval(t)}},100)}function c(e){e&&e.preventDefault();const t=document.getElementById("logoutModal");t&&t.classList.remove("hidden")}
